# 12장 리액티브로 더 깊이 들어가기

[toc]





# 리액티브는 언제 사용할까?

리액티브 스트림에 중점을 둔 애플리케이션은, 현재 다른 수단으로 달성하기 어려움 시스템 확장을 가능하게 한다.



리액티브 프로그래밍과 스프링 웹플럭스는 다음과 같은 상황에서 사용될수 있다:

1. ﻿﻿﻿높은 동시성이 필요할 때: 리액티브 프로그래밍은 비동기적으로 다수의 연 산을 처리할 수 있다. 전통적인 스레드 기반의 애플리케이션과 달리, 리액 티브 애플리케이션은 더 많은 동시 사용자와 트랜잭션을 효과적으로 처리 할 수 있다.
2. ﻿﻿﻿저지연 응답 시간이 필요할 때: 리액티브 시스템은 빠른 응답 시간을 제공 하기 위해 설계되었다. 연산이 블로킹되지 않기 때문에, 시스템은 항상 가 용 상태를 유지하며, 따라서 사용자에게 저지연 응답을 제공할 수 있다.
3. ﻿﻿﻿데이터 스트림 처리에 적합할 때: 스프링 웹플럭스는 데이터의 연속적인 스트림을 처리하는데 적합하다. 실시간 분석, 대용량 데이터 처리 및 스트 리밍 API와 같은 사용 사례에서 이러한 유형의 처리가 필요하다.
4. ﻿﻿﻿자원을 효율적으로 활용하고자 할 때: 리액티브 프로그래밍은 시스템 자원 을 보다 효율적으로 활용한다. 적은 수의 스레드로 많은 연산을 처리할 수 있어, 서버의 자원 사용률을 최적화하며, 이로 인해 전체적인 운영 비용을 줄일 수 있다.
5. ﻿﻿﻿외부 서비스 호출이 많거나 비동기 작업이 필요할 때: 여러 외부 서비스나 시스템에 대한 호출이 필요한 경우, 리액티브 프로그래밍은 이러한 서비스 간의 통신을 비동기적으로 처리하므로 전체 처리 시간을 단축시킬 수 있 다.
6. ﻿﻿﻿탄력성과 복원력이 중요할 때: 리액티브 시스템은 실패의 영향을 최소화하 고 빠르게 복구하는 능력을 갖추고 있다. 이는 중요한 비즈니스 요구 사항 을 충족시키기 위해 필요하다.
    따라서, 위와 같은 요구 사항이나 문제에 직면한 프로젝트에서 리액티브 프 로그래밍 및 스프링 웹플럭스를 고려할 수 있다.

리액티브 프로그래밍과 스프링 웹플럭스는 비동기 및 비차단 어플리케이션 개발을 위해 사용된다. 이러한 기술들은 시스템의 리소스를 더 효율적으로 활용할 수 있게 해주며, 특히 동시에 많은 수의 요청을 처리해야 하는 환경 에서 유용하다.

1. 리액티브 프로그래밍이 필요한 경우:

- ﻿﻿시스템이 고부하 상태에서도 높은 응답성을 유지해야 할 때
- ﻿﻿다수의 요청을 동시에 처리하며, 빠르게 응답해야 하는 시나리오에서
- ﻿﻿리소스 사용을 최적화하고, 스케일링 이슈를 효율적으로 관리해야 하 는 상황에서



2. 스프링 웹플럭스가 필요한 경우:

- ﻿﻿전통적인 서블릿 기반의 스프링 MVC가 고부하 상태에서의 동시 요청
   처리에 한계를 보일 때
- ﻿﻿마이크로서비스 아키텍처에서의 높은 확장성과 응답성이 필요할 때
- ﻿﻿비동기 및 논블로킹 데이터 스트림을 활용해, 데이터를 효율적으로 처 리해야 하는 상황에서

스프링 웹플럭스와 리액티브 프로그래밍은 이런 경우에 확장성 있고, 높은 성능의 어플리케이션을 구축할 수 있게 해준다. 그러나 개발 복잡성이 증가 할 수 있으므로, 프로젝트의 요구 사항과 개발 팀의 능력을 고려하여 적절히 선택해야 한다.



# 리액티브 애플리케이션 테스트

프로젝트 리액터에는 HOoks 클래스를 통해 사용할 수 있는 Hook라고 하는 설정 가능한 수명 주기 콜백이 포함됩니다. 

오류가 발생했을 때 필요한 정보를 찾는 데 특히 유용한 연산자는 onoperatorDebug() 입니다.

정상 작동하지 않는 Publisher 인스턴스의 생성 전에 Hooks. ondperatorDebug ()를 호출하면, 호출 이후 Publisher 타입 (및 하위 타입)의 모든 인스턴스의 어셈블리 타임을 정보 확인 수단으로 사용할 수 있습니다.

어셈블리 타임 정보를 수집하기 위해, 일반적으로 Hooks. onoperatorDebug ()는 다음과 같이 애플리케이션의 메인 메서드에 적습니다. 



모든 PubLisher에 백트레이스를 모두 출력하는 대신 주요 PubLisher 근처에 체크포인트를 설정해서 문제를 쉽게 해결할 수 있습니다. checkpoint () 연산자를 체인에 삼입하면 Hook 를 활성화하는 것처럼 작동하지만, 해당 연산자 체인의 해당 부분에 대해서만 작동합니다.

체크포인트에는 세 가지 변형이 있습니다.

- ﻿﻿백트레이스가 포함된 표준 체크포인트
- ﻿﻿내용을 설명하는 문자열 매개변수를 허용하고 백트레이스를 포함하지 않는 경량 체크포인트
- ﻿﻿내용을 설명하는 문자열 매개변수도 허용하는 백트레이스가 있는 표준 체크포인트



## 성능 저하 없이 트레이스 보는 방법 - ReactorDebugAgent

```groovy
implementation 'io.projectreactor:reactor-tools:3.5.0'
```

리액터 프로젝트에는 애플리케이션에 포함된 코드를 계측하는 데 사용되는 별도의 자바 에이 전트가 포함된 reactor-tools라는 라이브러리가 있습니다. react-tools는 디버깅 정보를 애플리케이션에 추가하고 실행 중인 애플리케이션에 연결해서 모든 후속 PubLisher의 실행을 추적하며, 성능 저하 없이 동일한 종류의 자세한 백트레이스 정보를 F100k로 제공합니다. 따