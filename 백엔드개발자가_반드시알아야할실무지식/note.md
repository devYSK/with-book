# 주니어 백엔드 개발자가 반드시 알아야 할 실무 지식





# **2장 느려진 서비스, 어디부터 봐야 할까**

네트워크, 디스크, 메모리, CPU 속도 등의 다양한 지표가 성능과 견롼뎌ㅙㅁ.



서버 성능은 주로 응답 시간과 처리량 에 달려있다. 

## 처리량과 응답 시간

![image-20250528165322207](./images//image-20250528165322207.png)

* 응답시간의 구성



서버 처리 시간은 다음과 같은 요소를 포함함

* 로직 수행 - if, for
* DB SQL
* 외부 API 속도
* 응답 데이터 생성(전송)

일반적으로, 최고 지연 시간은 DB 연동 속도와 API 연동 속도가 제일 많은 편이다. 로직은 길지 않다. 

### 처리량

처리량은 단위 시간당 시스템이 처리하는 작업량. TPS 또는 RPS로 표현

* TPS : 초당 처리 트랜잭션
* RPS : 초당 요청 수

TPS를 늘리는 방법은 2가지

1. 서버가 동시 처리할 수 있는 요청 수를  늘려 대기 시간 줄이기 (처리량을 넘어가면 다음요청은 대기하게됌)
2. 처리 시간 자체를 줄여  다른 요청 대기 시간을 줄이기

## 서버 성능 개선 기초

트래픽이 증가하면서 주로 성능 문제가 생김. 시스템 수용 가능 TPS를 초과하거나 데이터가 쌓이기 때문

모니터링 도구를 사용해 문제가 발생하는 지점을 먼저 찾아야 함. 

### DB 커넥션 풀

DB 사용시 다음단계 거침

1. DB 연결
2. 쿼리 실행
3. 응답 받고 연결 종료

여기 주 지연시간은 서버와 DB연결 및 종료가 꽤 맣은 레이턴시를 가짐. 

때문에 미리 연결된 커넥션을 생성해서 커넥션 풀에 담아 보유하는 방법을 사용함.



트래픽이 순간적으로 급증하는 패턴이 존재시, 커넥션 풀의 최소 크기를 최대 크기에 맞추는 것이 좋음.

* 즉, 최대 = 최소로 아예 처음부터 최대로 만들어놓는것.

* 단 DB 사용률이 CPU 80%를 넘기면, 그때는 줄여서 DB 서버가 포화되지 않도록 하는것이 더 나음

### 커넥션 대기시간

지정된 대기시간 안에 커넥션을 구하지 못하면 DB 연결 실패 에러 발생.

응답시간이 중요하다면 대기시간을 가능한 한 짧게 설정하는것이 좋음. 0.5초~3초. 

짧게 설정시, 커넥션 풀이 모두 사용중이라면 일시적 에러 메시지 보여줄 수 있음.

* 긴 시간 무응답보다, 빠르게 에러를 반환하는것이 사용자 경험에서 나을 수 있음. 서버 부하 증가 방지도 할 수 있음. 

### 최대 유휴시간, 유효성 검사, 최대 유지시간

새벽 시간대나 최대 어느정도 시간이 지나도 사용자가 없다면 커넥션은 끊는것이 나음.

커넥션 유효성 검사시 SELECT 1 등과 같은 쿼리 사용함. 

### 캐시 적중률과 사용 규칙

적중률 (hit rate) = 캐시에 존재한 건수 / 조회 시도 건수

캐시 갱신 방법

* LRU : 가장 오래전에 사용된
* LFU : 가장 적게 사용된
* FIFO : 먼저 추가된

많은 서비스는 최신 데이터를 조회하는 경향이 있으므로 오래된 데이터는 미리 삭제하자.

또한 TTL도 무시하지말자

### 로컬 캐시와 리모트 캐시

보통 서버용 캐시는 2가지. 로컬 캐시와 리모트 캐시

![image-20250528175855632](./images//image-20250528175855632.png)

로컬 캐시 구현 기술

* caffeine(자바), go-cache(Go)

로컬캐시

* 장점 : 속도. 구조면에서 단순함

* 단점 : 단점데이터 크기 제한. 서버 재시작시에 캐시 리셋. 

리모트 캐시 (ex : redis)

* 캐시 크기 유연하게 확장. 수평확장도 가능
* 단점 : 속도. 네트워크 통신 해야함. 

배포 빈도가 높은 서비스면 리모트 캐시 사용을 고려하자. 

### 캐시 사전 적제

가상의 사례

* 앱 사용자 300만명.
* 사용자에게 매달 정해진 날에 이달의 요금 정보르 ㄹ보여줌
* 정해진 날에 전체 대상으로 푸시 알림 발송
* 일부는 앱을 통해 요금 정보 조회

푸시알림 보내기전, 앱 캐시에 등록해놓으면 캐시 적중률 99% 가능



변경에 민감한 데이터를 리모트에 보관하자. 로컬캐시는 자신의 데이터만 변경하기 때문. 







# **3장 성능을 좌우하는 DB 설계와 쿼리**

성능에 핵심인 DB
조회 트래픽을 고려한 인덱스 설계
몇 가지 조회 성능 개선 방법
알아두면 좋을 몇 가지 주의 사항
실패와 트랜잭션 고려하기

# **4장 외부 연동이 문제일 때 살펴봐야 할 것들**

우리는 문제가 없는데
타임아웃
재시도
동시 요청 제한
서킷 브레이커
외부 연동과 DB 연동
HTTP 커넥션 풀
연동 서비스 이중화

# **5장 비동기 연동, 언제 어떻게 써야 할까**

동기 연동과 비동기 연동
별도 스레드로 실행하기
메시징
트랜잭션 아웃박스 패턴
배치 전송
CDC(Change Data Capture)

# **6장 동시성, 데이터가 꼬이기 전에 잡아야 한다**

서버와 동시 실행
잘못된 데이터 공유로 인한 문제 예시
프로세스 수준에서의 동시 접근 제어
DB와 동시성
잠금 사용 시 주의 사항
단일 스레드로 처리하기

# **7장 IO 병목, 어떻게 해결하지**

네트워크 IO와 자원 효율
가상 스레드로 자원 효율 높이기
논블로킹 IO로 성능 더 높이기
언제 어떤 방법을 택할까

# **8장 실무에서 꼭 필요한 보안 지식**

중요한 보안
인증과 인가
데이터 암호화
HMAC을 이용한 데이터 검증
방화벽으로 필요한 트래픽만 허용하기
감사 로그(audit log) 남기기
데이터 노출 줄이기
비정상 접근 처리
시큐어 코딩
개인 보안

# **9장 최소한 알고 있어야 할 서버 지식**

개발자와 서버
OS 계정과 권한
프로세스 확인하기
백그라운드 프로세스
디스크 용량 관리
파일 디스크립터 제한
시간 맞추기
크론으로 스케줄링하기
alias 등록하기
네트워크 정보 확인

# **10장 모르면 답답해지는 네트워크 기초**

네트워크 기초를 모르면
노드, 네트워크, 라우터
IP 주소와 도메인
NAT
VPN
프로토콜과 TCP, UDP, QUIC

# **11장 자주 쓰는 서버 구조와 설계 패턴**

MVC 패턴
계층형 아키텍처
DDD와 전술 패턴
마이크로서비스 아키텍처
이벤트 기반 아키텍처
CQRS 패턴

# **부록 A: 처음 해보는 성능 테스트를 위한 기본 정리**

성능 테스트 종류
포화점과 버클존
주요 측정 지표
성능 테스트 설계 시 고려 사항
성능 테스트 도구
성능 테스트 실행 시 주의 사항

# **부록 B: NoSQL 이해하기**

NoSQL이란
NoSQL 종류
NoSQL 도입 시 고려 사항
CAP 정리

# **부록 C: DB로 분산 잠금 구현하기**

잠금 정보 저장 테이블
분산 잠금 동작
DB 잠금 구현