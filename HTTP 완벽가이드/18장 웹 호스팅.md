# 18장 웹 호스팅

# 18.1 호스팅 서비스

ISP(Internet Service Provider)는 인터넷 서비스 제공자

 ISP는 개인, 비즈니스, 그리고 다양한 조직에 인터넷 접속 서비스를 제공하는 회사나 기관

클라우드와 비슷하지만 다르다.

네트워크. 하드웨어, 소프트웨어 유지보수, 업그레이드를 해준다

# 18.2 가상 호스팅

컴퓨터 한대를 여러 고객이 공유하게해서 저렴하게 이용하는것.

가상호스팅에서 `http://www.hardware.com/index.html`

로 요청하면 http 1.0에서는 Host 헤더가 없어 가상으로 호스팅 하기 힘들다.

그러나 http1.1은 Host헤더로 호스팅 컴퓨터를 구별해 호스팅할 수 있다.



**이점.**

* **자원 공유**: 하나의 서버가 여러 웹사이트의 호스팅을 담당하므로, 서버의 자원(예: CPU, 메모리, 저장 공간)이 여러 사이트에 의해 공유
* **비용 효율성**: 각 웹사이트는 서버의 전체 비용을 부담하지 않고, 필요한 만큼의 자원을 사용하는 비용만 지불
* **도메인 이름 기반 호스팅**: 웹 서버는 도메인 이름을 기반으로 요청을 구분하고, 적절한 웹사이트의 콘텐츠를 제공

다음 4가지 기술로 http1.0의 문제를 해결했다.

* URL 경로를 통한 가상 호스팅
  * 서버가 어떤 사이트를 요청하는 것인지 알 수 있게 URI에 특별한 경로 컴포넌트를 추가한다.
  * ex) -> www.domain.com/a컴퓨터/index.html, www.domain2.com/b컴퓨터/index.html
  * 불필요한 접두어라 혼란스럽다. 

* 포트번호를 통한 가상 호스팅
  * 각 사이트에 다른 포트번호를 할당하여, 분리된 웹 서버의 인스턴스가 요청을 처리 한다.
  * 사용자는 비표준 포트를 쓰지않고 찾길 원함. 80은 생략가능하지만 나머진 아닐 수 있다. 

* IP 주소를 통한 가상 호스팅
  * 각 가상 사이트에 별도의 IP 주소를 할당하고 모든 IP 주소를 장비 하나에 연결한다. 웹 서버는 IP 주소로 사이트 이름을 식별한다.
  * 단점 ; 한 컴퓨터가 연결할  수있는 장비의 IP개수 제한이 있음. IP주소는 또한 희소상품이라 얻기 어려움. 

* Host 헤더를 통한 가상 호스팅

  * HTTP/1.0의 개선 버전과 HTTP/1.1의 공식 버전은 사이트 이름을 알려주는 Host 요청 헤더를 정의했다. 웹 서버는 Host 헤더로 가상 사이트를 식별할 수 있다.

  * ```
    GET /index.html HTTP/1.1
    User-agent: SuperBrowser v1.3
    
    Host: www.joes-hardware.com
    ```

  * Host + url로 어디든지 접근가능. 

## Host 헤더

원본 URL에 있는 요청 리소스에 대한 인터넷 호스트와 포트ㅓ번호를 기술한다.

```
Host = "Host' ":" 호스트[  ":" 포트 ]
```

다음과 규칙이 있다.

- Host 헤더에 포트가 기술되어 있지 않으면, 해당 스킴(http, https)의 기본 포트를 사용한다.
- ﻿﻿URL에 IP 주소가 있으면, Host 헤더는 같은 주소를 포함해야 한다.
- ﻿﻿URL에 호스트 명이 기술되어 있으면, Host 헤더는 같은 호스트 명을 포함해야 한다.
- ﻿﻿URL에 호스트 명이 기술되어 있으면, Host 헤더는 URL의 호스트 명이 가리키는 IP 주소를 포함해서는 안 된다. 그 이유는, 여러 개의 가상 사이트를 한 개의 IP 주소에 연결한 가상 호스트 서버에서 문제가 될 수 있기 때문이다.
- ﻿﻿클라이언트가 `특정 프락시 서버를 사용`한다면, Host 헤더에 프락시 서버가 아닌 `원 서버의 호스트 명과 포트`를 기술해야 한다. 과거에는 여러 웹 클라이언트가 프락시 설정이 활성화되어 있을 때 전송하는 Host 헤더에 프락시의 호스트 명을 넣는 버그가 있었다. 이 문제는 프락시와 원 서버를 오동작시키는 원인이 된다.
- ﻿﻿웹 클라이언트는 모든 요청 메시지에 Host 헤더를 기술해야 한다.
- ﻿﻿웹 프락시는 요청을 전달하기 전에 요청 메시지에 Host 헤더를 추가해야 한다.
- ﻿﻿HTTP/1.1 웹 서버는 Host 헤더 필드가 없는 HTTP/1.1 요청 메시지를 받으면 400 상태 코드로 응답해야 한다. 1?

# 18.3 안정적인 웹 사이트 만들기

웹사이트 장애상황

1. 서버 다운
2. 트래픽 폭증
3. 네트워크 장애 손실

해결방법

* 미러링 서버 팜 : 스케일아웃과 비슷한 형태다. 마스터 슬레이브라고도 볼 수 있다. 
* CDN : 프락시 서버나 프락시 캐시 사용. 

# 18.4 웹 사이트 빠르게 만들기

* 캐시 사용
* 프락시 사용
* 스케일 아웃 사용
* 콘텐츠 인코딩 - gzip

